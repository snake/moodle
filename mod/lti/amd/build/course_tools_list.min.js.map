{"version":3,"file":"course_tools_list.min.js","sources":["../src/course_tools_list.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Course LTI External tools list management.\n *\n * @module      mod_lti/course_tools_list\n * @copyright   2023 Jake Dallimore <jrhdallimore@gmail.com>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\"use strict\";\n\nimport Notification from 'core/notification';\nimport Pending from 'core/pending';\nimport Ajax from 'core/ajax';\nimport {add as addToast} from 'core/toast';\nimport {prefetchStrings} from 'core/prefetch';\nimport {get_string as getString} from 'core/str';\nimport {refreshTableContent} from 'core_table/dynamic';\nimport * as Selectors from 'core_table/local/dynamic/selectors';\n\n/**\n * Initialise module.\n */\nexport const init = () => {\n    prefetchStrings('mod_lti', [\n        'deletecoursetool',\n        'deletecoursetoolconfirm',\n        'coursetooldeleted'\n    ]);\n\n    prefetchStrings('core', [\n        'delete',\n    ]);\n\n    document.addEventListener('click', event => {\n\n        const courseToolDelete = event.target.closest('[data-action=\"course-tool-delete\"]');\n        if (courseToolDelete) {\n            event.preventDefault();\n\n            // Use triggerElement to return focus to the action menu toggle.\n            const triggerElement = courseToolDelete.closest('.dropdown').querySelector('.dropdown-toggle');\n            Notification.saveCancelPromise(\n                getString('deletecoursetool', 'mod_lti'),\n                getString('deletecoursetoolconfirm', 'mod_lti', courseToolDelete.dataset.courseToolName),\n                getString('delete', 'core'),\n                {triggerElement}\n            ).then(() => {\n                const pendingPromise = new Pending('mod_lti/course_tools:delete');\n\n                const request = {\n                    methodname: 'mod_lti_delete_course_tool_type',\n                    args: {tooltypeid: courseToolDelete.dataset.courseToolId}\n                };\n                Ajax.call([request])[0]\n                    .then(addToast(getString('coursetooldeleted', 'mod_lti')))\n                    .then(() => {\n                        const tableRoot = triggerElement.closest(Selectors.main.region);\n                        return refreshTableContent(tableRoot);\n                    })\n                    .then(pendingPromise.resolve)\n                    .catch(Notification.exception);\n            }).catch(() => {\n                return;\n            });\n        }\n    });\n};\n"],"names":["document","addEventListener","event","courseToolDelete","target","closest","preventDefault","triggerElement","querySelector","saveCancelPromise","dataset","courseToolName","then","pendingPromise","Pending","request","methodname","args","tooltypeid","courseToolId","call","tableRoot","Selectors","main","region","resolve","catch","Notification","exception"],"mappings":"8/CAqCoB,mCACA,UAAW,CACvB,mBACA,0BACA,oDAGY,OAAQ,CACpB,WAGJA,SAASC,iBAAiB,SAASC,cAEzBC,iBAAmBD,MAAME,OAAOC,QAAQ,yCAC1CF,iBAAkB,CAClBD,MAAMI,uBAGAC,eAAiBJ,iBAAiBE,QAAQ,aAAaG,cAAc,0CAC9DC,mBACT,mBAAU,mBAAoB,YAC9B,mBAAU,0BAA2B,UAAWN,iBAAiBO,QAAQC,iBACzE,mBAAU,SAAU,QACpB,CAACJ,eAAAA,iBACHK,MAAK,WACGC,eAAiB,IAAIC,iBAAQ,+BAE7BC,QAAU,CACZC,WAAY,kCACZC,KAAM,CAACC,WAAYf,iBAAiBO,QAAQS,6BAE3CC,KAAK,CAACL,UAAU,GAChBH,MAAK,eAAS,mBAAU,oBAAqB,aAC7CA,MAAK,WACIS,UAAYd,eAAeF,QAAQiB,UAAUC,KAAKC,eACjD,gCAAoBH,cAE9BT,KAAKC,eAAeY,SACpBC,MAAMC,sBAAaC,cACzBF,OAAM"}