define ("core_course/chooser_dialogue",["exports","jquery","core/modal_events","core_course/local/chooser/selectors","core/modal_factory","core/templates","core/str","core/key_codes"],function(a,b,c,d,f,g,h,i){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.displayChooser=void 0;b=k(b);c=j(c);d=k(d);f=j(f);g=j(g);function j(a){if(a&&a.__esModule){return a}else{var b={};if(null!=a){for(var c in a){if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};if(d.get||d.set){Object.defineProperty(b,c,d)}else{b[c]=a[c]}}}}b.default=a;return b}}function k(a){return a&&a.__esModule?a:{default:a}}function l(a,b){return o(a)||n(a,b)||m()}function m(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function n(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function o(a){if(Array.isArray(a))return a}function p(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function q(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){p(h,d,e,f,g,"next",a)}function g(a){p(h,d,e,f,g,"throw",a)}f(void 0)})}}var r=function(){var a=q(regeneratorRuntime.mark(function a(b,c,e,f){var h,i,j,k,l,m,n;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:h=b.target.closest(d.default.regions.chooserOption.container);i=h.dataset.modname;a.next=4;return g.renderForPromise("core_course/chooser_help",c.get(i));case 4:j=a.sent;k=j.html;l=j.js;m=e.getBody()[0].querySelector(d.default.regions.help);a.next=10;return g.replaceNodeContents(m,k,l);case 10:f.carousel("next");f.carousel("pause");n=m.querySelector(d.default.regions.chooserSummary.content);n.focus();case 14:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}(),s=function(a,c){a.getBody()[0].addEventListener("click",function(){var e=q(regeneratorRuntime.mark(function f(g){var e;return regeneratorRuntime.wrap(function(f){while(1){switch(f.prev=f.next){case 0:e=(0,b.default)(d.default.regions.carousel);e.carousel();e.carousel("pause");if(!g.target.closest(d.default.actions.optionActions.showSummary)){f.next=6;break}f.next=6;return r(g,c,a,e);case 6:if(g.target.matches(d.default.actions.closeOption)){e.carousel("prev");e.carousel("dispose")}case 7:case"end":return f.stop();}}},f)}));return function(){return e.apply(this,arguments)}}());t(a,c)},t=function(a,c){var e=document.querySelectorAll(d.default.regions.chooserOption.container);Array.from(e).forEach(function(e){return e.addEventListener("keyup",function(){var e=q(regeneratorRuntime.mark(function f(g){var e,h,j,k,l,m,n,o,p;return regeneratorRuntime.wrap(function(f){while(1){switch(f.prev=f.next){case 0:if(!(g.keyCode===i.arrowRight||g.keyCode===i.arrowLeft)){f.next=7;break}if(!g.target.matches(d.default.actions.optionActions.showSummary)){f.next=7;break}e=(0,b.default)(d.default.regions.carousel);e.carousel();e.carousel("pause");f.next=7;return r(g,c,a,e);case 7:if(g.keyCode===i.arrowRight){if(!g.target.matches(d.default.actions.optionActions.showSummary)){h=g.target.closest(d.default.regions.chooserOption.container);j=h.nextElementSibling;u(j)}}if(g.keyCode===i.arrowLeft){if(!g.target.matches(d.default.actions.optionActions.showSummary)){k=g.target.closest(d.default.regions.chooserOption.container);l=k.previousElementSibling;u(l)}}if(g.keyCode===i.home){m=document.querySelector(d.default.regions.chooserOptions);n=m.firstElementChild;n.focus()}if(g.keyCode===i.end){o=document.querySelector(d.default.regions.chooserOptions);p=o.lastElementChild;p.focus()}case 11:case"end":return f.stop();}}},f)}));return function(){return e.apply(this,arguments)}}())})},u=function(a){if(null!==a){a.focus()}},v=function(){var a=q(regeneratorRuntime.mark(function a(b,d){var e,i,j,k,m;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:e=document.querySelector(".section-modchooser-text[data-sectionid=\"".concat(b.target.dataset.sectionid,"\"]"));a.t0=Promise;a.t1=f;a.t2=f.types.DEFAULT;a.next=6;return(0,h.get_string)("addresourceoractivity");case 6:a.t3=a.sent;a.t4=g.render("core_course/chooser",d);a.t5={type:a.t2,title:a.t3,body:a.t4,large:!0};a.t6=a.t1.create.call(a.t1,a.t5);a.t7=[a.t6];a.next=13;return a.t0.all.call(a.t0,a.t7);case 13:i=a.sent;j=l(i,1);k=j[0];m=new Map;d.allmodules.forEach(function(a){m.set(a.modulename,a)});k.getRoot().on(c.bodyRendered,function(a){var b=document.querySelector("[data-region=\"".concat(a.target.dataset.region,"\"]"));b.classList.add("modchooser");s(k,m)});k.getRoot().on(c.hidden,function(){k.destroy();try{e.closest(".section-modchooser-link").focus()}catch(a){}});k.show();case 21:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();a.displayChooser=v});
//# sourceMappingURL=chooser_dialogue.min.js.map
