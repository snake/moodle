define ("core_course/chooser_dialogue",["jquery","core/modal_factory","core/modal_events","core/templates","core/custom_interaction_events"],function(a,b,c,d,e){var f={CHOOSER_CONTAINER:"[data-region=\"chooser-container\"]",CHOOSER_OPTIONS_CONTAINER:"[data-region=\"chooser-options-container\"]",CHOOSER_OPTION_CONTAINER:"[data-region=\"chooser-option-container\"]",CHOOSER_OPTION_ACTIONS_CONTAINER:"[data-region=\"chooser-option-actions-container\"]",CHOOSER_OPTION_INFO_CONTAINER:"[data-region=\"chooser-option-info-container\"]",CHOOSER_OPTION_SUMMARY_CONTAINER:"[data-region=\"chooser-option-summary-container\"]",CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER:"[data-region=\"chooser-option-summary-content-container\"]",CHOOSER_OPTION_SUMMARY_ACTIONS_CONTAINER:"[data-region=\"chooser-option-summary-actions-container\"]",CHOOSER_OPTION_ACTIONS:{SHOW_CHOOSER_OPTION_SUMMARY:"[data-action=\"show-option-summary\"]"},ADD_CHOOSER_OPTION:"[data-action=\"add-chooser-option\"]",CLOSE_CHOOSER_OPTION_SUMMARY:"[data-action=\"close-chooser-option-summary\"]"},g=function(){var b=a(f.CHOOSER_OPTION_ACTIONS.SHOW_CHOOSER_OPTION_SUMMARY);e.define(b,[e.events.activate]);b.on(e.events.activate,function(b){var c=a(b.target).closest(f.CHOOSER_OPTION_CONTAINER).find(f.CHOOSER_OPTION_SUMMARY_CONTAINER);i(c)});var c=a(f.CLOSE_CHOOSER_OPTION_SUMMARY);e.define(c,[e.events.activate]);c.on(e.events.activate,function(b){var c=a(b.target).closest(f.CHOOSER_OPTION_SUMMARY_CONTAINER);c.removeClass("open");a(f.CHOOSER_CONTAINER).removeClass("noscroll")});h()},h=function(){var b=a(f.CHOOSER_OPTION_CONTAINER);e.define(b,[e.events.next,e.events.previous,e.events.home,e.events.end]);b.on(e.events.next,function(b){var c=a(b.target),d=c.next();if("undefined"==typeof d){return}d.focus()});b.on(e.events.previous,function(b){var c=a(b.target),d=c.prev();if("undefined"==typeof d){return}d.focus()});b.on(e.events.next,f.ADD_CHOOSER_OPTION,function(b,c){var d=a(c.originalEvent.currentTarget),e=d.next();if("undefined"==typeof e){return}e.focus()});b.on(e.events.previous,f.ADD_CHOOSER_OPTION,function(b,c){var d=a(c.originalEvent.currentTarget),e=d.prev();if("undefined"==typeof e){return}e.focus()});b.on(e.events.next,f.CHOOSER_OPTION_ACTIONS.SHOW_CHOOSER_OPTION_SUMMARY,function(b,c){var d=a(c.originalEvent.currentTarget),e=d.next();if("undefined"==typeof e){return}e.focus()});b.on(e.events.previous,f.CHOOSER_OPTION_ACTIONS.SHOW_CHOOSER_OPTION_SUMMARY,function(b,c){var d=a(c.originalEvent.currentTarget),e=d.prev();if("undefined"==typeof e){return}e.focus()});b.on(e.events.home,function(){var b=a(f.CHOOSER_OPTIONS_CONTAINER).find(f.CHOOSER_OPTION_CONTAINER),c=a(b).first();c.focus()});b.on(e.events.end,function(){var b=a(f.CHOOSER_OPTIONS_CONTAINER).find(f.CHOOSER_OPTION_CONTAINER),c=a(b).last();c.focus()});var c=a(f.SHOW_CHOOSER_OPTION_SUMMARY);e.define(c,[e.events.keyboardActivate]);c.on(e.events.keyboardActivate,function(b){var c=a(b.target).closest(f.CHOOSER_OPTION_CONTAINER).find(f.CHOOSER_OPTION_SUMMARY_CONTAINER);i(c)})},i=function(b){var c=a(f.CHOOSER_CONTAINER).scrollTop(),d=a(f.CHOOSER_CONTAINER).outerHeight();a(f.CHOOSER_CONTAINER).addClass("noscroll");j(b,c,d);var e=b.find(f.CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER);if(0<e.scrollTop()){e.scrollTop(0)}b.addClass("open");var g=b.find(f.CLOSE_CHOOSER_OPTION_SUMMARY),h=b.find(f.ADD_CHOOSER_OPTION);b.attr("tabindex",0);g.attr("tabindex",0);h.attr("tabindex",0);b.focus()},j=function(a,b,c){var d=a.find(f.CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER),e=a.find(f.CHOOSER_OPTION_SUMMARY_ACTIONS_CONTAINER),g=c-e.outerHeight();d.css({height:g+"px"});a.css({top:b+"px",height:c+"px"})};return{displayChooser:function displayChooser(h,e){return d.render("core_course/chooser",e).then(function(d){return b.create({type:b.types.DEFAULT,body:d,title:e.title,large:!0}).then(function(b){b.getRoot().on(c.shown,function(b){a(b.target).addClass("modchooser");var c=a(f.CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER).find("a");c.each(function(b,c){a(c).attr("tabindex",-1)});g()});b.getRoot().on(c.hidden,function(){a(h.target.closest(".chooser-link")).focus();b.getRoot().remove()});b.show();return b})})}}});
//# sourceMappingURL=chooser_dialogue.min.js.map
