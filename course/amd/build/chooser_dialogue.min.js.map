{"version":3,"sources":["../src/chooser_dialogue.js"],"names":["define","$","ModalFactory","ModalEvents","Templates","CustomEvents","SELECTORS","CHOOSER_CONTAINER","CHOOSER_OPTIONS_CONTAINER","CHOOSER_OPTION_CONTAINER","CHOOSER_OPTION_ACTIONS_CONTAINER","CHOOSER_OPTION_INFO_CONTAINER","CHOOSER_OPTION_SUMMARY_CONTAINER","CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER","CHOOSER_OPTION_SUMMARY_ACTIONS_CONTAINER","CHOOSER_OPTION_ACTIONS","SHOW_CHOOSER_OPTION_SUMMARY","ADD_CHOOSER_OPTION","CLOSE_CHOOSER_OPTION_SUMMARY","registerListenerEvents","showChooserOptionSummary","events","activate","on","e","optionSummaryElement","target","closest","find","showOptionSummary","closeChooserOptionSummary","removeClass","initKeyboardNavigation","chooserOption","next","previous","home","end","currentOption","nextOption","focus","previousOption","prev","data","originalEvent","currentTarget","chooserOptions","first","last","keyboardActivate","topPosition","scrollTop","height","outerHeight","addClass","setOptionSummaryPositionAndHeight","optionSummaryContentElement","cancelAction","addAction","attr","positionTop","optionSumaryActionsElement","contentHeight","css","displayChooser","render","then","html","create","type","types","DEFAULT","body","title","large","modal","getRoot","shown","optionSummaryContentAnchors","each","key","anchor","hidden","remove","show"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * A type of dialogue used as for choosing options.\n *\n * @module     core_course/chooser_dialogue\n * @package    core\n * @copyright  2019 Mihail Geshoski <mihail@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      3.8\n */\n\ndefine(\n    [\n        'jquery',\n        'core/modal_factory',\n        'core/modal_events',\n        'core/templates',\n        'core/custom_interaction_events',\n    ],\n    function(\n        $,\n        ModalFactory,\n        ModalEvents,\n        Templates,\n        CustomEvents\n    ) {\n\n    /**\n     * Class names for different elements.\n     *\n     * @private\n     * @type {Object}\n     */\n    var SELECTORS = {\n        CHOOSER_CONTAINER: '[data-region=\"chooser-container\"]',\n        CHOOSER_OPTIONS_CONTAINER: '[data-region=\"chooser-options-container\"]',\n        CHOOSER_OPTION_CONTAINER: '[data-region=\"chooser-option-container\"]',\n        CHOOSER_OPTION_ACTIONS_CONTAINER: '[data-region=\"chooser-option-actions-container\"]',\n        CHOOSER_OPTION_INFO_CONTAINER: '[data-region=\"chooser-option-info-container\"]',\n        CHOOSER_OPTION_SUMMARY_CONTAINER: '[data-region=\"chooser-option-summary-container\"]',\n        CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER: '[data-region=\"chooser-option-summary-content-container\"]',\n        CHOOSER_OPTION_SUMMARY_ACTIONS_CONTAINER: '[data-region=\"chooser-option-summary-actions-container\"]',\n        CHOOSER_OPTION_ACTIONS: {\n            SHOW_CHOOSER_OPTION_SUMMARY: '[data-action=\"show-option-summary\"]',\n        },\n        ADD_CHOOSER_OPTION: '[data-action=\"add-chooser-option\"]',\n        CLOSE_CHOOSER_OPTION_SUMMARY: '[data-action=\"close-chooser-option-summary\"]',\n    };\n\n    /**\n     * Register chooser related event listeners.\n     *\n     * @method registerListenerEvents\n     */\n    var registerListenerEvents = function() {\n\n        var showChooserOptionSummary = $(SELECTORS.CHOOSER_OPTION_ACTIONS.SHOW_CHOOSER_OPTION_SUMMARY);\n\n        CustomEvents.define(showChooserOptionSummary, [\n            CustomEvents.events.activate\n        ]);\n\n        // Show the chooser option summary.\n        showChooserOptionSummary.on(CustomEvents.events.activate, function(e) {\n            var optionSummaryElement = $(e.target).closest(SELECTORS.CHOOSER_OPTION_CONTAINER)\n                .find(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTAINER);\n            showOptionSummary(optionSummaryElement);\n        });\n\n        var closeChooserOptionSummary = $(SELECTORS.CLOSE_CHOOSER_OPTION_SUMMARY);\n\n        CustomEvents.define(closeChooserOptionSummary, [\n            CustomEvents.events.activate\n        ]);\n\n        // Close the chooser option summary.\n        closeChooserOptionSummary.on(CustomEvents.events.activate, function(e) {\n            var optionSummaryElement = $(e.target).closest(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTAINER);\n            optionSummaryElement.removeClass('open');\n            $(SELECTORS.CHOOSER_CONTAINER).removeClass('noscroll');\n        });\n\n        // Register event listeners related to the keyboard navigation controls.\n        initKeyboardNavigation();\n    };\n\n    /**\n     * Initialise the keyboard navigation controls for the chooser.\n     *\n     * @method initKeyboardNavigation\n     */\n    var initKeyboardNavigation = function() {\n\n        var chooserOption = $(SELECTORS.CHOOSER_OPTION_CONTAINER);\n\n        CustomEvents.define(chooserOption, [\n            CustomEvents.events.next,\n            CustomEvents.events.previous,\n            CustomEvents.events.home,\n            CustomEvents.events.end\n        ]);\n\n        chooserOption.on(CustomEvents.events.next, function(e) {\n            var currentOption = $(e.target);\n            var nextOption = currentOption.next();\n            if (typeof nextOption === 'undefined') {\n                return;\n            }\n            nextOption.focus();\n        });\n\n        chooserOption.on(CustomEvents.events.previous, function(e) {\n            var currentOption = $(e.target);\n            var previousOption = currentOption.prev();\n            if (typeof previousOption === 'undefined') {\n                return;\n            }\n            previousOption.focus();\n        });\n\n        chooserOption.on(CustomEvents.events.next, SELECTORS.ADD_CHOOSER_OPTION, function(e, data) {\n            var currentOption = $(data.originalEvent.currentTarget);\n            var nextOption = currentOption.next();\n            if (typeof nextOption === 'undefined') {\n                return;\n            }\n            nextOption.focus();\n        });\n\n        chooserOption.on(CustomEvents.events.previous, SELECTORS.ADD_CHOOSER_OPTION, function(e, data) {\n            var currentOption = $(data.originalEvent.currentTarget);\n            var previousOption = currentOption.prev();\n            if (typeof previousOption === 'undefined') {\n                return;\n            }\n            previousOption.focus();\n        });\n\n        chooserOption.on(CustomEvents.events.next, SELECTORS.CHOOSER_OPTION_ACTIONS.SHOW_CHOOSER_OPTION_SUMMARY,\n            function(e, data) {\n                var currentOption = $(data.originalEvent.currentTarget);\n                var nextOption = currentOption.next();\n                if (typeof nextOption === 'undefined') {\n                    return;\n                }\n                nextOption.focus();\n            });\n\n        chooserOption.on(CustomEvents.events.previous, SELECTORS.CHOOSER_OPTION_ACTIONS.SHOW_CHOOSER_OPTION_SUMMARY,\n            function(e, data) {\n                var currentOption = $(data.originalEvent.currentTarget);\n                var previousOption = currentOption.prev();\n                if (typeof previousOption === 'undefined') {\n                    return;\n                }\n                previousOption.focus();\n            });\n\n        chooserOption.on(CustomEvents.events.home, function() {\n            var chooserOptions = $(SELECTORS.CHOOSER_OPTIONS_CONTAINER).find(SELECTORS.CHOOSER_OPTION_CONTAINER);\n            var previousOption = $(chooserOptions).first();\n            previousOption.focus();\n        });\n\n        chooserOption.on(CustomEvents.events.end, function() {\n            var chooserOptions = $(SELECTORS.CHOOSER_OPTIONS_CONTAINER).find(SELECTORS.CHOOSER_OPTION_CONTAINER);\n            var nextOption = $(chooserOptions).last();\n            nextOption.focus();\n        });\n\n        var showChooserOptionSummary = $(SELECTORS.SHOW_CHOOSER_OPTION_SUMMARY);\n\n        CustomEvents.define(showChooserOptionSummary, [\n            CustomEvents.events.keyboardActivate\n        ]);\n\n        showChooserOptionSummary.on(CustomEvents.events.keyboardActivate, function(e) {\n            var optionSummaryElement = $(e.target).closest(SELECTORS.CHOOSER_OPTION_CONTAINER)\n                .find(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTAINER);\n            showOptionSummary(optionSummaryElement);\n        });\n    };\n\n    /**\n      * Show the option summary for a particular chooser option.\n      *\n      * @method showOptionSummary\n      * @param {jQuery} optionSummaryElement The option summary container element\n      */\n    var showOptionSummary = function(optionSummaryElement) {\n        // Get the current scroll position of the chooser container element.\n        var topPosition = $(SELECTORS.CHOOSER_CONTAINER).scrollTop();\n        // Get the height of the chooser container element.\n        var height = $(SELECTORS.CHOOSER_CONTAINER).outerHeight();\n        // Disable the scroll of the chooser container element.\n        $(SELECTORS.CHOOSER_CONTAINER).addClass('noscroll');\n\n        setOptionSummaryPositionAndHeight(optionSummaryElement, topPosition, height);\n\n        var optionSummaryContentElement = optionSummaryElement.find(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER);\n        // Set the scroll of the type summary content element to top.\n        if (optionSummaryContentElement.scrollTop() > 0) {\n            optionSummaryContentElement.scrollTop(0);\n        }\n        // Show the particular summary overlay.\n        optionSummaryElement.addClass('open');\n        var cancelAction = optionSummaryElement.find(SELECTORS.CLOSE_CHOOSER_OPTION_SUMMARY);\n        var addAction = optionSummaryElement.find(SELECTORS.ADD_CHOOSER_OPTION);\n\n        optionSummaryElement.attr('tabindex', 0);\n        cancelAction.attr('tabindex', 0);\n        addAction.attr('tabindex', 0);\n        optionSummaryElement.focus();\n    };\n\n    /**\n      * Set the top position and height of the option summary container.\n      * This is used to align the top position and height of the option summary container\n      * with the chooser options container.\n      *\n      * @method setOptionSummaryPositionAndHeight\n      * @param {jQuery} optionSummaryElement The option summary container element\n      * @param {int} positionTop The top position attributed to the option summary container element\n      * @param {int} height The height attributed to the option summary container element\n      */\n    var setOptionSummaryPositionAndHeight = function(optionSummaryElement, positionTop, height) {\n        var optionSummaryContentElement = optionSummaryElement.find(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER);\n        var optionSumaryActionsElement = optionSummaryElement.find(SELECTORS.CHOOSER_OPTION_SUMMARY_ACTIONS_CONTAINER);\n        var contentHeight = height - optionSumaryActionsElement.outerHeight();\n        optionSummaryContentElement.css({'height': contentHeight + 'px'});\n\n        optionSummaryElement.css({'top': positionTop + 'px', 'height': height + 'px'});\n    };\n\n    /**\n      * Display the module chooser.\n      *\n      * @method displayChooser\n      * @param {EventFacade} e Triggering Event\n      * @param {Object} data Object containing the data required by the chooser template\n      * @returns {Promise}\n      */\n    var displayChooser = function(e, data) {\n        return Templates.render('core_course/chooser', data)\n            .then(function(html) {\n                return ModalFactory.create({\n                    type: ModalFactory.types.DEFAULT,\n                    body: html,\n                    title: data.title,\n                    large: true\n                }).then(function(modal) {\n                    modal.getRoot().on(ModalEvents.shown, function(e) {\n                        $(e.target).addClass('modchooser');\n                        // Initially, omit any anchor elements from the focus order in the summary content container.\n                        var optionSummaryContentAnchors = $(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER).find('a');\n                        optionSummaryContentAnchors.each(function(key, anchor) {\n                            $(anchor).attr('tabindex', -1);\n                        });\n                        // Register event listeners.\n                        registerListenerEvents();\n                    });\n\n                    // We want to focus on the action select when the dialog is closed.\n                    modal.getRoot().on(ModalEvents.hidden, function() {\n                        $(e.target.closest('.chooser-link')).focus();\n                        modal.getRoot().remove();\n                    });\n\n                    modal.show();\n\n                    return modal;\n                });\n            });\n    };\n\n    return /** @alias module:core/chooser_dialogue */{\n        displayChooser: displayChooser\n    };\n});\n"],"file":"chooser_dialogue.min.js"}